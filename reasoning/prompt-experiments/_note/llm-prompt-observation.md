# LLM 프롬프트 및 질의·응답 기록 (자연어 → 논리식 변환)

본 문서는  
PHR 조건을 자연어로 입력받아 논리식으로 변환하는 실험에서  
**실제로 사용한 프롬프트, LLM 호출 설정, 예제 질의와 응답**을  
잊지 않기 위해 남긴 개인 기록용 노트이다.

본 문서는 설명이나 결론을 위한 문서가 아니라,  
**실험 당시 사용한 원문 기록**에 가깝다.

---

## 시스템 프롬프트 (고정 규칙)

당신은 자연어 조건을 논리식으로 변환하는 엔진입니다.

[규칙]
- 사용자가 입력한 필드명과 괄호() 구조를 최대한 유지하십시오.
- '이고', '이면서', 'and' 는 ∧ 로 변환하십시오.
- '이거나', '또는', 'or' 는 ∨ 로 변환하십시오.
- '이상'은 ≥, '이하'는 ≤, '초과'는 >, '미만'은 <, '동일'은 = 로 변환하십시오.
- 출력은 논리식 한 줄만 하며, 다른 설명은 절대 포함하지 마십시오.

예시:
입력: (키 170 이상 or 몸무게 80) and 혈당 100
출력: (키 ≥ 170 ∨ 몸무게 ≥ 80) ∧ 혈당 = 100

---

## LLM 호출 설정 메모

- 호출 방식: HTTP completion API
- 모델 실행 환경: 로컬 CPU 기반 llama.cpp
- 요청 시 포함 요소:
  - 시스템 프롬프트
  - 직전 사용자 입력 및 직전 출력 (최대 1쌍)
  - 현재 사용자 입력

- 주요 파라미터:
  - temperature: 0.1
  - n_predict: 128
  - stop 토큰: 개행, "입력:"
  - stream: false

- 컨텍스트 전략:
  - 전체 대화 히스토리 미포함
  - 시스템 프롬프트 + 직전 대화 일부만 포함

---

## 예제 질의 및 응답 추가 기록

### 예제 A (복합 조건 + 중첩 괄호)

입력:
((나이 65 이상 이거나 (키 150 미만 이고 몸무게 40 이하)) 이면서 공복혈당 126 이상) 또는 ((체질량지수 30 이상 이고 허리둘레 90 초과) 이면서 요단백 양성)

출력:
(((나이 ≥ 65 ∨ (키 < 150 ∧ 몸무게 ≤ 40))) ∧ 공복혈당 ≥ 126) ∨ ((체질량지수 ≥ 30 ∧ 허리둘레 > 90) ∧ 요단백 양성)

---

### 예제 B (AND / OR 우선순위 해석)

입력:
몸무게가 100 이상이거나 키가 178 이하 그리고 공복혈당 100 이하인 사람

출력:
(몸무게 ≥ 100 ∨ (키 ≤ 178 ∧ 공복혈당 ≤ 100))

---

### 예제 C (후처리: 특정 조건 제거)

기존 수식:
(몸무게 ≥ 100 ∨ (키 ≤ 178 ∧ 공복혈당 ≤ 100))

요청:
위 식에서 키를 빼줘

결과:
(몸무게 ≥ 100 ∨ 공복혈당 ≤ 100)
